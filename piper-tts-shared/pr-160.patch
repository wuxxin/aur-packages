From 901bb5e2dcfba71363c20bca0386e3ec0c743c46 Mon Sep 17 00:00:00 2001
From: CodingAndCodingAgain
 <158087544+CodingAndCodingAgain@users.noreply.github.com>
Date: Sun, 18 Jan 2026 15:38:53 +0100
Subject: [PATCH] feat: added ROCMExecutionProvider for amd gpus docs: updated
 docs

---
 docs/API_PYTHON.md | 8 ++++++++
 src/piper/voice.py | 9 +++++++++
 2 files changed, 17 insertions(+)

diff --git a/docs/API_PYTHON.md b/docs/API_PYTHON.md
index c81882408..2c423de86 100644
--- a/docs/API_PYTHON.md
+++ b/docs/API_PYTHON.md
@@ -45,6 +45,14 @@ voice = PiperVoice.load(..., use_cuda=True)
 
 This requires the `onnxruntime-gpu` package to be installed.
 
+To use ROCm for GPU acceleration in AMD GPUs instead:
+
+``` python
+voice = PiperVoice.load(..., use_rocm=True)
+```
+
+This requires the `onnxruntime-rocm` package to be [installed](https://rocm.docs.amd.com/projects/radeon-ryzen/en/docs-6.1.3/docs/install/native_linux/install-onnx.html) and the appropiate version of torch to be used. You can find more information in [here](https://rocm.docs.amd.com/projects/radeon-ryzen/en/latest/docs/install/installrad/native_linux/install-pytorch.html#verify-pytorch-installation)
+
 For streaming, use `PiperVoice.synthesize`:
 
 ``` python
diff --git a/src/piper/voice.py b/src/piper/voice.py
index 93700e981..386d3974f 100644
--- a/src/piper/voice.py
+++ b/src/piper/voice.py
@@ -12,6 +12,7 @@
 from typing import Any, Iterable, Optional, Sequence, Tuple, Union
 
 import numpy as np
+import torch
 import onnxruntime
 
 from .config import PhonemeType, PiperConfig, SynthesisConfig
@@ -121,6 +122,7 @@ def load(
         model_path: Union[str, Path],
         config_path: Optional[Union[str, Path]] = None,
         use_cuda: bool = False,
+        use_rocm: bool = False,
         espeak_data_dir: Union[str, Path] = ESPEAK_DATA_DIR,
     ) -> "PiperVoice":
         """
@@ -148,6 +150,13 @@ def load(
                 )
             ]
             _LOGGER.debug("Using CUDA")
+        elif use_rocm:
+            providers = [
+                (
+                    "ROCMExecutionProvider"
+                )
+            ]
+            _LOGGER.debug("Using ROCm")
         else:
             providers = ["CPUExecutionProvider"]
 
